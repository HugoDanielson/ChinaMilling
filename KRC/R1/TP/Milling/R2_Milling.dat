&ACCESS RV1
&REL 4
&PARAM DISKPATH = KRC:\R1\TP\Milling
DEFDAT  R2_MILLING PUBLIC

GLOBAL SIGNAL gDoSto1 $OUT[1037]
GLOBAL SIGNAL gDoSto2 $OUT[1038]
GLOBAL SIGNAL gDoQuickStop $OUT[1051]
GLOBAL SIGNAL gDiExtEmStop $IN[241]
GLOBAL SIGNAL gDiExtOpSafAckn $IN[255]

GLOBAL SIGNAL gDOChangeToolEnable $OUT[130]
GLOBAL SIGNAL gDIChangeToolEnableOK $IN[160]
GLOBAL SIGNAL gDOToolRelease $OUT[131]
GLOBAL SIGNAL gDIToolReleasedOK $IN[125]
GLOBAL SIGNAL gDOToolClamp $OUT[132]

GLOBAL SIGNAL DI_MillQuitMessageByPLC $IN[601]

GLOBAL SIGNAL gDISpindleActSpeed $IN[224]  TO $IN[239]
GLOBAL SIGNAL gDISpindleEnableOK $IN[161]
GLOBAL SIGNAL iConverterStatus $IN[208]  TO $IN[223]

GLOBAL SIGNAL oFreqconverterCtlw $OUT[101]  TO $OUT[116] ; instead of cw in sps 
GLOBAL SIGNAL oSpindleOperMode $OUT[117]  TO $OUT[124]
GLOBAL SIGNAL oConverterSetSpeed $OUT[601]  TO $OUT[616]
GLOBAL SIGNAL gDOSpindleEnable $OUT[133]


DECL GLOBAL BOOL gbSpindleStart=FALSE
DECL GLOBAL BOOL gbTooleReleaseReq=FALSE
DECL GLOBAL INT gnSpindleOperatinMode=2


GLOBAL STRUC sSpindleWord INT RunSpindle,StopDec1,QuickStop,WaitForCommand
DECL GLOBAL sSpindleWord gsSpindleWord={RunSpindle 127,StopDec1 128,QuickStop 129,WaitForCommand 126}

GLOBAL INT gISetSpeed=0
GLOBAL INT gIActSpeed=-8000
GLOBAL INT giSpindlespeedchecksum=-800
GLOBAL BOOL gbRobControlActive=FALSE
GLOBAL BOOL gbRobControlEnable=FALSE
GLOBAL BOOL gbRobControlRequest=FALSE
GLOBAL BOOL gbMillSystemWarning=FALSE
GLOBAL BOOL gbDirectionClockwise=TRUE
GLOBAL BOOL gbSpindleRunning=FALSE
GLOBAL INT cycEmStop=30
GLOBAL INT oMinSpindleRpm=0
GLOBAL INT oMaxSpindleRpm=15000
GLOBAL INT gnActSpindleSpeed=0
GLOBAL INT gnSetSpindleSpeedHmi=5000
GLOBAL BOOL gbSpindleDirCcw=FALSE
GLOBAL BOOL gbSpindleDirCw=FALSE
GLOBAL BOOL gbClampHmiEnable=FALSE
GLOBAL BOOL gbSpindleClamp=FALSE
GLOBAL BOOL gbSpindleRelease=FALSE
GLOBAL BOOL gbTableClamp=FALSE
GLOBAL BOOL gbSpindleBlowOff=FALSE


GLOBAL ENUM TYPMillDirection CLOCKWISE,COUNTERCLOCKWISE
GLOBAL STRUC sR2Param REAL VC,FZ,AP,Dia,NrE,RPM,rSpeed,FRAME toolOffset
DECL GLOBAL sR2Param gsR2Param[16]
gsR2Param[1]={VC 0.100000,FZ 0.200000,AP 0.300000,Dia 24.0000,NrE 3.00000,toolOffset {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}}


ENDDAT